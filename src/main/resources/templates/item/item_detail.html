<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
</head>

<body>
	<div th:replace="fragments/header_user :: header"></div>

	<main>
		<div>

			<p><img th:src="@{'/images/items/' + ${item.image}}" alt="商品画像"></p>
			<p>価格:<span th:text="${item.price}"></span></p>
		</div>

		<div>
			<p>出品者:<span th:text="${item.account.name}"></span>
					<a th:href="@{/mypage/user/{id}/detail(id=${item.account.id})}">出品者プロフィールを見る</a>
				</p>
			<p>商品名:<span th:text="${item.name}"></span></p>
			<p>商品詳細:<br><span th:text="${item.memo}"></span></p>

		</div>

		<!-- ログイン済 & 自分の商品 -->
		<div th:if="${account != null} and ${item.account.id == account.id}">
			<p>※この商品はあなたが出品したものです。</p>
		</div>

		<!-- ログイン済 & 他人の商品 -->
		<div th:if="${account != null} and ${item.account.id != account.id}">
			<form th:action="@{/order/{itemId}(itemId=${item.id})}" method="get">
				<button>購入する</button>
			</form>
			<form th:action="@{/chat}" method="post">
				<input type="hidden" name="itemId" th:value="${item.id}" />
				<input type="hidden" name="ownerId" th:value="${item.account.id}" />
				<button>チャットを始める</button>
			</form>
		</div>

		<!-- 未ログイン -->
		<div th:if="${account == null}">
			<form th:action="@{/order/{itemId}(itemId=${item.id})}" method="get">
				<button>購入する（ログインが必要です）</button>
			</form>
			<form th:action="@{/chat/redirect}" method="get">
				<input type="hidden" name="itemId" th:value="${item.id}" />
				<input type="hidden" name="ownerId" th:value="${item.account.id}" />
				<button>チャットを始める（ログインが必要です）</button>
			</form>
		</div>
		<a th:href="@{/items}">← 一覧へ</a>
	</main>
</body>

</html>
